<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Helpful operator notes and techniques in actionable form"><link href=https://obscuritylabs.com/windows/network_sa_cmds/ rel=canonical><meta name=author content="Obscurity Labs LLC."><link rel="shortcut icon" href=../../img/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-5.5.14"><title>Network Situational Awareness - Operator Up</title><link rel=stylesheet href=../../assets/stylesheets/main.d3202873.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ff0a5ce4.min.css><meta name=theme-color content=#000000><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-64026800-6","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=black data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#windows-network-situational-awareness-commands class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://obscuritylabs.com/ title="Operator Up" class="md-header-nav__button md-logo" aria-label="Operator Up"> <img src=../../img/logo_transparent_crop.jpg alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Operator Up </span> <span class="md-header-nav__topic md-ellipsis"> Network Situational Awareness </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/obscuritylabs/operator-up/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> obscuritylabs/operator-up </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../priv_esc/ class="md-tabs__link md-tabs__link--active"> Windows </a> </li> <li class=md-tabs__item> <a href=../../scanning/nmap/ class=md-tabs__link> Scanning </a> </li> <li class=md-tabs__item> <a href=../../web_app/sql_injections/ class=md-tabs__link> Web Application </a> </li> <li class=md-tabs__item> <a href=../../osint/email/ class=md-tabs__link> OSINT </a> </li> <li class=md-tabs__item> <a href=../../soc/sysmon/sysmon/ class=md-tabs__link> SOC </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://obscuritylabs.com/ title="Operator Up" class="md-nav__button md-logo" aria-label="Operator Up"> <img src=../../img/logo_transparent_crop.jpg alt=logo> </a> Operator Up </label> <div class=md-nav__source> <a href=https://github.com/obscuritylabs/operator-up/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> obscuritylabs/operator-up </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../building/ title=Building class=md-nav__link> Building </a> </li> <li class=md-nav__item> <a href=../../contributing/ title=Contributing class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=../../license/ title=License class=md-nav__link> License </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5 checked> <label class=md-nav__link for=nav-5> Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Windows data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"></span> Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../priv_esc/ title="Privilege Escalation" class=md-nav__link> Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../local_sa_cmds/ title="Host Situational Awareness" class=md-nav__link> Host Situational Awareness </a> </li> <li class=md-nav__item> <a href=../remote_sa_cmds/ title="Remote Situational Awareness" class=md-nav__link> Remote Situational Awareness </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Network Situational Awareness <span class="md-nav__icon md-icon"></span> </label> <a href=./ title="Network Situational Awareness" class="md-nav__link md-nav__link--active"> Network Situational Awareness </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#powerview-situational-awareness class=md-nav__link> PowerView Situational Awareness </a> <nav class=md-nav aria-label="PowerView Situational Awareness"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-computers-in-ldap-search-base-and-show-the-dns-name-and-os-only class=md-nav__link> Get computers in LDAP search base and show the DNS name and OS only </a> </li> <li class=md-nav__item> <a href=#computers-with-os-matching-2008-with-a-ou-of-intrest class=md-nav__link> Computers with OS matching 2008, with a OU of intrest </a> </li> <li class=md-nav__item> <a href=#computers-in-ldap-search-base-and-pipe-host-names-of-intrest-to-get-netsession class=md-nav__link> Computers in LDAP search base and pipe host names of intrest to Get-NetSession </a> </li> <li class=md-nav__item> <a href=#remote-desktop-users-for-a-machine-for-just-medium-intg-rdp class=md-nav__link> Remote Desktop Users for a machine for just medium intg RDP </a> </li> <li class=md-nav__item> <a href=#admins-for-a-machine-for-just-medium-intg-rdp class=md-nav__link> Admins for a machine for just medium intg RDP </a> </li> <li class=md-nav__item> <a href=#corelate-gpos-to-domain-system class=md-nav__link> Corelate GPOs to domain system </a> </li> <li class=md-nav__item> <a href=#find-all-computers-and-pipe-into-local-admins-of-machines class=md-nav__link> Find all computers and pipe into local admins of machines </a> </li> <li class=md-nav__item> <a href=#find-all-computer-objects-systems-that-have-a-gpo-applied class=md-nav__link> Find all computer objects / systems that have a GPO applied </a> </li> <li class=md-nav__item> <a href=#find-all-accounts-with-admin-count-set-dc-sync class=md-nav__link> Find all accounts with admin count set / DC sync </a> </li> <li class=md-nav__item> <a href=#check-if-user-has-rights-to-dc-sync-with-the-pdc class=md-nav__link> Check if user has rights to DC sync with the PDC </a> </li> <li class=md-nav__item> <a href=#pull-all-emails-from-user-object-of-a-certain-ou-and-output-to-file-for-download class=md-nav__link> Pull all email's from user object of a certain OU and output to file for download </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../remote_alteration/ title="Remote Alteration" class=md-nav__link> Remote Alteration </a> </li> <li class=md-nav__item> <a href=../lat_movement/ title="Lateral Movement" class=md-nav__link> Lateral Movement </a> </li> <li class=md-nav__item> <a href=../persistence/ title=Persistence class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../collection_operations/ title="Collection Operations" class=md-nav__link> Collection Operations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Scanning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Scanning data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"></span> Scanning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../scanning/nmap/ title=nmap class=md-nav__link> nmap </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Web Application <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Web Application" data-md-level=1> <label class=md-nav__title for=nav-7> <span class="md-nav__icon md-icon"></span> Web Application </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web_app/sql_injections/ title="SQL Injections" class=md-nav__link> SQL Injections </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> OSINT <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=OSINT data-md-level=1> <label class=md-nav__title for=nav-8> <span class="md-nav__icon md-icon"></span> OSINT </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../osint/email/ title=Email class=md-nav__link> Email </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class=md-nav__link for=nav-9> SOC <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SOC data-md-level=1> <label class=md-nav__title for=nav-9> <span class="md-nav__icon md-icon"></span> SOC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../soc/sysmon/sysmon/ title=sysmon class=md-nav__link> sysmon </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#powerview-situational-awareness class=md-nav__link> PowerView Situational Awareness </a> <nav class=md-nav aria-label="PowerView Situational Awareness"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-computers-in-ldap-search-base-and-show-the-dns-name-and-os-only class=md-nav__link> Get computers in LDAP search base and show the DNS name and OS only </a> </li> <li class=md-nav__item> <a href=#computers-with-os-matching-2008-with-a-ou-of-intrest class=md-nav__link> Computers with OS matching 2008, with a OU of intrest </a> </li> <li class=md-nav__item> <a href=#computers-in-ldap-search-base-and-pipe-host-names-of-intrest-to-get-netsession class=md-nav__link> Computers in LDAP search base and pipe host names of intrest to Get-NetSession </a> </li> <li class=md-nav__item> <a href=#remote-desktop-users-for-a-machine-for-just-medium-intg-rdp class=md-nav__link> Remote Desktop Users for a machine for just medium intg RDP </a> </li> <li class=md-nav__item> <a href=#admins-for-a-machine-for-just-medium-intg-rdp class=md-nav__link> Admins for a machine for just medium intg RDP </a> </li> <li class=md-nav__item> <a href=#corelate-gpos-to-domain-system class=md-nav__link> Corelate GPOs to domain system </a> </li> <li class=md-nav__item> <a href=#find-all-computers-and-pipe-into-local-admins-of-machines class=md-nav__link> Find all computers and pipe into local admins of machines </a> </li> <li class=md-nav__item> <a href=#find-all-computer-objects-systems-that-have-a-gpo-applied class=md-nav__link> Find all computer objects / systems that have a GPO applied </a> </li> <li class=md-nav__item> <a href=#find-all-accounts-with-admin-count-set-dc-sync class=md-nav__link> Find all accounts with admin count set / DC sync </a> </li> <li class=md-nav__item> <a href=#check-if-user-has-rights-to-dc-sync-with-the-pdc class=md-nav__link> Check if user has rights to DC sync with the PDC </a> </li> <li class=md-nav__item> <a href=#pull-all-emails-from-user-object-of-a-certain-ou-and-output-to-file-for-download class=md-nav__link> Pull all email's from user object of a certain OU and output to file for download </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/obscuritylabs/operator-up/windows/network_sa_cmds.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=windows-network-situational-awareness-commands>Windows Network Situational Awareness Commands<a class=headerlink href=#windows-network-situational-awareness-commands title="Permanent link">&para;</a></h1> <h2 id=powerview-situational-awareness>PowerView Situational Awareness<a class=headerlink href=#powerview-situational-awareness title="Permanent link">&para;</a></h2> <p><em>PowerView is a PowerShell tool to gain network situational awareness on Windows domains. It contains a set of pure-PowerShell replacements for various windows "net *" commands, which utilize PowerShell AD hooks and underlying Win32 API functions to perform useful Windows domain functionality.</em></p> <p><em>It also implements various useful metafunctions, including some custom-written user-hunting functions which will identify where on the network specific users are logged into. It can also check which machines on the domain the current user has local administrator access on. Several functions for the enumeration and abuse of domain trusts also exist. See function descriptions for appropriate usage and available options. For detailed output of underlying functionality, pass the -Verbose or -Debug flags.</em></p> <p><em>For functions that enumerate multiple machines, pass the -Verbose flag to get a progress status as each host is enumerated. Most of the "meta" functions accept an array of hosts from the pipeline.</em><sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>All command can be run via PowerPick to increase your OPSEC. Reducing your forensic artifact impact. <em>Allowing the execution of Powershell functionality without the use of Powershell.exe. Primarily this project uses.NET assemblies/libraries to start execution of the Powershell scripts</em><sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup></p> </div> <h3 id=get-computers-in-ldap-search-base-and-show-the-dns-name-and-os-only>Get computers in LDAP search base and show the DNS name and OS only<a class=headerlink href=#get-computers-in-ldap-search-base-and-show-the-dns-name-and-os-only title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-DomainComputer</span> <span class=n>-searchbase</span> <span class=s2>&quot;LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com&quot;</span> <span class=p>-</span><span class=n>-Properties</span> <span class=n>dnshostname</span><span class=p>,</span><span class=n>operatingsystem</span>
</code></pre></div> <h3 id=computers-with-os-matching-2008-with-a-ou-of-intrest>Computers with OS matching 2008, with a OU of intrest<a class=headerlink href=#computers-with-os-matching-2008-with-a-ou-of-intrest title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-DomainComputer</span> <span class=n>-searchbase</span> <span class=s2>&quot;LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com&quot;</span> <span class=n>-OperatingSystem</span> <span class=p>*</span><span class=n>2008</span><span class=p>*</span> 
</code></pre></div> <h3 id=computers-in-ldap-search-base-and-pipe-host-names-of-intrest-to-get-netsession>Computers in LDAP search base and pipe host names of intrest to Get-NetSession<a class=headerlink href=#computers-in-ldap-search-base-and-pipe-host-names-of-intrest-to-get-netsession title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=n>powerpick</span> <span class=nb>Get-DomainComputer</span> <span class=n>-SearchBase</span> <span class=s2>&quot;LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com&quot;</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=n>dnshostname</span> <span class=o>-like</span> <span class=s2>&quot;*HOST-NAME*&quot;</span><span class=p>}</span> <span class=p>|</span> <span class=nb>Get-NetSession</span> 
</code></pre></div> <h3 id=remote-desktop-users-for-a-machine-for-just-medium-intg-rdp>Remote Desktop Users for a machine for just medium intg RDP<a class=headerlink href=#remote-desktop-users-for-a-machine-for-just-medium-intg-rdp title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-NetLocalGroupMember</span> <span class=n>HOST-NAME</span> <span class=n>-GroupName</span> <span class=s2>&quot;Remote Desktop Users&quot;</span>
</code></pre></div> <h3 id=admins-for-a-machine-for-just-medium-intg-rdp>Admins for a machine for just medium intg RDP<a class=headerlink href=#admins-for-a-machine-for-just-medium-intg-rdp title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-NetLocalGroupMember</span> <span class=n>HOST-NAME</span>
</code></pre></div> <h3 id=corelate-gpos-to-domain-system>Corelate GPOs to domain system<a class=headerlink href=#corelate-gpos-to-domain-system title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-NetOU</span> <span class=n>-GPLink</span> <span class=s2>&quot;{45172B9C-749A-479A-A9C7-4F85083CD517}&quot;</span> <span class=p>|</span> <span class=p>%</span> <span class=p>{</span> <span class=nb>Get-DomainComputer</span> <span class=n>-ADSPath</span> <span class=nv>$_</span><span class=p>.</span><span class=n>distinguishedname</span> <span class=n>-Properties</span> <span class=n>dnshostname</span><span class=p>}</span>
</code></pre></div> <h3 id=find-all-computers-and-pipe-into-local-admins-of-machines>Find all computers and pipe into local admins of machines<a class=headerlink href=#find-all-computers-and-pipe-into-local-admins-of-machines title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-DomainComputer</span> <span class=n>-searchbase</span> <span class=s2>&quot;LDAP://OU=Location Location,OU=SOME,DC=am,DC=somthing,DC=com&quot;</span> <span class=n>-Properties</span> <span class=n>name</span> <span class=n>FindOne</span> <span class=p>|</span> <span class=nb>Get-NetLocalGroupMember</span> <span class=n>-Method</span> <span class=n>API</span> <span class=n>-Properties</span> <span class=n>ComputerName</span><span class=p>,</span><span class=n>GroupName</span><span class=p>,</span><span class=n>MemberName</span><span class=p>|</span> <span class=nb>FT </span><span class=n>-Wrap</span>
</code></pre></div> <h3 id=find-all-computer-objects-systems-that-have-a-gpo-applied>Find all computer objects / systems that have a GPO applied<a class=headerlink href=#find-all-computer-objects-systems-that-have-a-gpo-applied title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-DomainOU</span> <span class=n>-GPLink</span> <span class=s2>&quot;{A8E139C2-8A5C-455B-905F-FF509D112E8C}&quot;</span> <span class=p>|</span> <span class=p>%</span> <span class=p>{</span> <span class=nb>Get-DomainComputer</span> <span class=n>-ADSPath</span> <span class=nv>$_</span><span class=p>.</span><span class=n>distinguishedname</span> <span class=n>-Properties</span> <span class=n>dnshostname</span><span class=p>}</span>
</code></pre></div> <h3 id=find-all-accounts-with-admin-count-set-dc-sync>Find all accounts with admin count set / DC sync<a class=headerlink href=#find-all-accounts-with-admin-count-set-dc-sync title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-DomainUser</span> <span class=n>-admincount</span> <span class=n>-Properties</span> <span class=n>samaccountname</span>
</code></pre></div> <h3 id=check-if-user-has-rights-to-dc-sync-with-the-pdc>Check if user has rights to DC sync with the PDC<a class=headerlink href=#check-if-user-has-rights-to-dc-sync-with-the-pdc title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>Get-ObjectACL</span> <span class=s2>&quot;DC=testlab,DC=local&quot;</span> <span class=n>-ResolveGUIDs</span> <span class=p>|</span> <span class=p>?</span> <span class=p>{</span>
    <span class=p>(</span><span class=nv>$_</span><span class=p>.</span><span class=n>ActiveDirectoryRights</span> <span class=o>-match</span> <span class=s1>&#39;GenericAll&#39;</span><span class=p>)</span> <span class=o>-or</span> <span class=p>(</span><span class=nv>$_</span><span class=p>.</span><span class=n>ObjectAceType</span> <span class=o>-match</span> <span class=s1>&#39;Replication-Get&#39;</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <h3 id=pull-all-emails-from-user-object-of-a-certain-ou-and-output-to-file-for-download>Pull all email's from user object of a certain OU and output to file for download<a class=headerlink href=#pull-all-emails-from-user-object-of-a-certain-ou-and-output-to-file-for-download title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>get-domainuser</span> <span class=n>-searchbase</span> <span class=s2>&quot;LDAP://OU=place,OU=thing,DC=domain,DC=loves,DC=com&quot;</span> <span class=n>-properties</span> <span class=n>cn</span><span class=p>,</span><span class=n>mail</span><span class=p>,</span><span class=n>userprincipalname</span><span class=p>,</span><span class=n>extensionattribute10</span><span class=p>,</span><span class=n>msrtcsip-primaryuseraddress</span> <span class=p>|</span> <span class=nb>out-file</span> <span class=n>-encoding</span> <span class=n>ASCII</span> <span class=n>C</span><span class=p>:\</span><span class=n>Windows</span><span class=p>\</span><span class=n>Tasks</span><span class=p>\</span><span class=n>contacts</span><span class=p>.</span><span class=n>txt</span>
</code></pre></div> <div class=footnote> <hr> <ol> <li id=fn:1> <p><a href=https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon#powerview>https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon#powerview</a>&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p><a href=https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick>https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick</a>&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> </ol> </div> <hr> <div class=md-source-date> <small> Last update: May 7, 2020 </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../remote_sa_cmds/ title="Remote Situational Awareness" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Remote Situational Awareness </div> </div> </a> <a href=../remote_alteration/ title="Remote Alteration" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Remote Alteration </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020-2020 Obscurity Labs LLC. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/squidfunk target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/squidfunk target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://linkedin.com/in/squidfunk target=_blank rel=noopener title=linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.2d1db4bd.min.js></script> <script src=../../assets/javascripts/bundle.6627ddf3.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: ['instant', 'tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>